REM ============================================================================
REM –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –°–ö–†–ò–ü–¢ –°–û–ó–î–ê–ù–ò–Ø SpellChecker.exe –î–õ–Ø WINDOWS
REM ============================================================================
REM 
REM –≠—Ç–æ—Ç batch-—Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
REM 1. –°–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
REM 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
REM 3. –°–æ–±–∏—Ä–∞–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π .exe —Ñ–∞–π–ª
REM 
REM –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
REM - Python 3.8+ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ PATH
REM - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤
REM 
REM –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:
REM 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø–∞–ø–∫—É –Ω–∞ Windows
REM 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç batch-—Ñ–∞–π–ª –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
REM 3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
REM 4. –ì–æ—Ç–æ–≤—ã–π SpellChecker.exe –±—É–¥–µ—Ç –≤ –ø–∞–ø–∫–µ dist\
REM
REM ============================================================================

@echo off
chcp 65001 > nul
setlocal EnableDelayedExpansion

echo.
echo ‚ö° –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –°–ë–û–†–ö–ê SpellChecker.exe ‚ö°
echo ==========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Python
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: Python –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo.
    echo üìã –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:
    echo    1. Python 3.8 –∏–ª–∏ –Ω–æ–≤–µ–µ
    echo    2. Python –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ PATH  
    echo.
    echo üí° –°–∫–∞—á–∞–π—Ç–µ Python —Å https://python.org
    echo    –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–º–µ—Ç—å—Ç–µ "Add Python to PATH"
    echo.
    pause
    exit /b 1
)

echo ‚úÖ Python –Ω–∞–π–¥–µ–Ω:
python --version
echo.

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
if not exist "spell_checker_windows.py" (
    echo ‚ùå –û–®–ò–ë–ö–ê: –§–∞–π–ª spell_checker_windows.py –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo.
    echo üìã –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É:
    echo    - spell_checker_windows.py
    echo    - SpellChecker_Windows.spec
    echo    - –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
    echo.
    pause
    exit /b 1
)

echo üìÅ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è...
if exist "venv" (
    echo ‚ö†Ô∏è  –ü–∞–ø–∫–∞ venv —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É–¥–∞–ª—è–µ–º...
    rmdir /s /q venv
)

python -m venv venv
if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ!
    pause
    exit /b 1
)
echo ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ

echo.
echo üì¶ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤...
call venv\Scripts\activate.bat

echo üì• –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ pip...
python -m pip install --upgrade pip

echo üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ requests...
pip install requests

echo üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ beautifulsoup4...
pip install beautifulsoup4

echo üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pyinstaller...
pip install pyinstaller

if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã!
    echo üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    pause
    exit /b 1
)
echo ‚úÖ –í—Å–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

echo.
echo üî® –°–±–æ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞...
echo ‚è≥ –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç...

if exist "SpellChecker_Windows.spec" (
    echo üìã –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SpellChecker_Windows.spec
    pyinstaller SpellChecker_Windows.spec
) else (
    echo üìã –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    pyinstaller --onefile --name SpellChecker --console spell_checker_windows.py
)

if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª!
    echo.
    echo üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    echo    - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
    echo    - –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç PyInstaller
    echo    - –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
    echo.
    echo üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
    echo    1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    echo    2. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–Ω—Ç–∏–≤–∏—Ä—É—Å
    echo    3. –û—Å–≤–æ–±–æ–¥–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
    echo.
    pause
    exit /b 1
)

echo.
echo üéâ –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û! üéâ
echo ===============================
echo.

if exist "dist\SpellChecker.exe" (
    echo ‚úÖ –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω: dist\SpellChecker.exe
    
    REM –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
    for %%I in ("dist\SpellChecker.exe") do set size=%%~zI
    set /a size_mb=!size!/1024/1024
    
    echo üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: !size_mb! –ú–ë
    echo.
    
    echo üöÄ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ:
    echo.
    echo üíª –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞:
    echo    1. –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ dist\SpellChecker.exe
    echo    2. run_spellchecker.bat
    echo    3. –ò–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏: dist\SpellChecker.exe
    echo.
    
    echo üìÅ –§–∞–π–ª—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä:
    echo    - dist\SpellChecker.exe (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª)
    echo    - run_spellchecker.bat (–¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)
    echo.
    
    echo üß™ –•–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å? (y/n)
    set /p test_choice="–í–∞—à –≤—ã–±–æ—Ä: "
    
    if /i "!test_choice!"=="y" (
        echo.
        echo üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...
        echo ‚è≥ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
        echo üí° –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å –æ—à–∏–±–∫–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: "–ø—Ä–µ–≤–µ—Ç –∫–∞–∫ –¥–∏–ª–∞"
        echo üö™ –î–ª—è –≤—ã—Ö–æ–¥–∞ –≤–≤–µ–¥–∏—Ç–µ: q
        echo.
        pause
        start "" "dist\SpellChecker.exe"
    )
    
) else (
    echo ‚ùå –í–ù–ò–ú–ê–ù–ò–ï: –§–∞–π–ª dist\SpellChecker.exe –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É dist\ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤
    if exist "dist" (
        echo üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ dist\:
        dir /b dist\
    )
)

echo.
echo üìã –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê
echo ===================
echo ‚úÖ –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª: dist\SpellChecker.exe  
echo üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: BUILD_WINDOWS.md
echo üé¨ –î–µ–º–æ: demo_windows.bat
echo.

echo üí° –°–æ–≤–µ—Ç: –î–æ–±–∞–≤—å—Ç–µ SpellChecker.exe –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π PATH
echo    –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞!
echo.

pause
echo.
echo üéä –°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SpellChecker! üéä
